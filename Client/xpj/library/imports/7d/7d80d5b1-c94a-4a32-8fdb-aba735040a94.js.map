{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\ZJH/assets\\Script\\SceneScript\\ZJH\\Game_TimeDown.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\ZJH","sourcesContent":["import { mp_manager } from './../../Modules/ModuleManager';\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game_TimeDown extends cc.Component {\r\n    /**\r\n     * 倒计时图片\r\n     * @type {cc.Sprite}\r\n     * @memberof Game_TimeDown\r\n     */\r\n    @property(cc.Sprite)\r\n    img_td: cc.Sprite = null;\r\n    /**\r\n     * 倒计时时间总数\r\n     * @memberof Game_TimeDown\r\n     */\r\n    _timeCount = 0;\r\n    /**\r\n     * 当前时间\r\n     * @memberof Game_TimeDown\r\n     */\r\n    _curTime = 0;\r\n    /**\r\n     * 是否播放音效\r\n     * @memberof Game_TimeDown\r\n     */\r\n    _isPlayEfc = false;\r\n    /**\r\n     * 回调函数\r\n     * @memberof Game_TimeDown\r\n     */\r\n    _cb = null;\r\n    /**\r\n     * 播放音效的时间\r\n     * @type {number}\r\n     * @memberof Game_TimeDown\r\n     */\r\n    _playTime: number = 0;\r\n    onLoad() {\r\n\r\n    }\r\n\r\n    /**\r\n     * 初始化数据\r\n     * @param {number} curTime 当前时间\r\n     * @param {number} timeCount 总共时间\r\n     * @param {boolean} isPlayEfc 是否播放音效\r\n     * @param {cc.Node} parentNode 父节点\r\n     * @param {any} cb            回调函数\r\n     * @memberof Game_TimeDown\r\n     */\r\n    initData(curTime: number, timeCount: number, isPlayEfc: boolean, parentNode: cc.Node, cb?: any) {\r\n        this._timeCount = timeCount;\r\n        this._curTime = curTime;\r\n        this._isPlayEfc = isPlayEfc;\r\n        this.node.parent = parentNode;\r\n        this.img_td.fillRange = 1;\r\n        this._cb = cb;\r\n    }\r\n    /**\r\n     * 播放anim动画，\r\n     * @param {any} startTime 开始位子\r\n     * @param {any} pos       坐标点\r\n     * @param {any} parentNode 父节点\r\n     * @memberof Game_TimeDown\r\n     */\r\n    initDataWithAnim(startTime: number, parentNode: cc.Node) {\r\n        this.node.parent = parentNode;\r\n        let anim = this.node.getComponent(cc.Animation);\r\n        anim.play(\"game_djsAction\", startTime);\r\n    }\r\n\r\n    update(dt) {\r\n        if (this._curTime <= this._timeCount) {\r\n            this._curTime += dt;\r\n            let pro = this._curTime / this._timeCount;\r\n            if (pro < 0) {\r\n                pro = 0;\r\n            } else if (pro > 1) {\r\n                pro = 1;\r\n            } else {\r\n                pro = pro;\r\n            }\r\n            this.img_td.fillRange = 1 - pro;\r\n\r\n            if (pro < 0.33) {\r\n                this.img_td.node.color = new cc.Color(31, 255, 0);\r\n            } else if (pro > 0.33 && pro < 0.66) {\r\n                this.img_td.node.color = new cc.Color(50, 160, 255);\r\n            } else {\r\n                this.img_td.node.color = new cc.Color(255, 43, 43);\r\n            }\r\n            if (this._isPlayEfc) {\r\n                if (pro >= 0.5) {\r\n                    this._playTime -= dt;\r\n                    if (this._playTime <= 0) {\r\n                        this._playTime = 0.8;\r\n                        mp_manager.playTime();\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            this.img_td.fillRange = 0;\r\n            if (this._cb) {\r\n                this._cb();\r\n                //执行一次就清除，防止循环请求\r\n                this._cb = null;\r\n            }\r\n        }\r\n    }\r\n}\r\n"]}