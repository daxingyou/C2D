{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\ZJH/assets\\Script\\SceneScript\\ZJH\\ZJH_ActionPK.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\ZJH","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\nimport * as dd from './../../Modules/ModuleManager';\r\nimport * as ZJH_Help from './ZJH_Help';\r\n@ccclass\r\nexport default class ZJH_ActionPK extends cc.Component {\r\n    /**\r\n     * 头像列表\r\n     * \r\n     * @type {cc.Sprite[]}\r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    @property([cc.Sprite])\r\n    headImgList: cc.Sprite[] = [];\r\n    /**\r\n     * 金币列表\r\n     * \r\n     * @type {cc.Label[]}\r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    @property([cc.Label])\r\n    lblMoneyList: cc.Label[] = [];\r\n    /**\r\n     * 名字列表\r\n     * \r\n     * @type {cc.Label[]}\r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    @property([cc.Label])\r\n    lblNameList: cc.Label[] = [];\r\n    /**\r\n     * 庄节点表\r\n     * \r\n     * @type {cc.Node[]}\r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    @property([cc.Node])\r\n    dImgList: cc.Node[] = [];\r\n    /**\r\n     * canvas脚本\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    _canvansScript = null;\r\n\r\n    onLoad() {\r\n        this.node.on('touchend', (event) => {\r\n            event.stopPropagation();\r\n        }, this);\r\n        this._canvansScript = dd.ui_manager.getCanvasNode().getComponent('ZJHCanvas');\r\n        this.initData();\r\n    }\r\n\r\n    /**\r\n     * 初始化数据\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    initData() {\r\n        let seatList: SeatVo[] = [];\r\n        //比牌发起座位\r\n        let compareSrcSeat = ZJH_Help.getSeatBySeatId(dd.gm_manager.zjhGameData.compareSrcIndex);\r\n        let compareDstSeat = ZJH_Help.getSeatBySeatId(dd.gm_manager.zjhGameData.compareDstIndex);\r\n        seatList.push(compareSrcSeat);\r\n        seatList.push(compareDstSeat);\r\n\r\n        for (var i = 0; i < seatList.length; i++) {\r\n            let seat = seatList[i];\r\n            if (seat) {\r\n                this.headImgList[i].spriteFrame = dd.img_manager.getHeadById(Number(seat.headImg));\r\n                this.dImgList[i].active = seat.accountId === dd.gm_manager.zjhGameData.bankerId ? true : false;\r\n                this.lblMoneyList[i].string = dd.utils.getShowNumberString(seat.money);\r\n                this.lblNameList[i].string = seat.nick;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 比牌结果，显示赢家和比牌失败的特效\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    bpResult() {\r\n        let kdNode = null;\r\n        if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n            kdNode = this.dImgList[1].parent;\r\n        } else {\r\n            kdNode = this.dImgList[0].parent;\r\n        }\r\n        if (kdNode) {\r\n            this._canvansScript.showBPSBAction(cc.p(0, 0), kdNode);\r\n        }\r\n    }\r\n    /**\r\n     * 比牌开始\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    showBPStart() {\r\n        this.dImgList[0].parent.runAction(cc.fadeIn(0.5));\r\n        this.dImgList[1].parent.runAction(cc.fadeIn(0.5));\r\n    }\r\n\r\n    /**\r\n     * 显示比牌失败，失败的一方渐隐\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    showBPSB() {\r\n        let action = cc.fadeOut(0.5);\r\n        if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n            this.dImgList[1].parent.runAction(action);\r\n        } else {\r\n            this.dImgList[0].parent.runAction(action);\r\n        }\r\n        \r\n        let mySeat = ZJH_Help.getSeatById(dd.ud_manager.mineData.accountId);\r\n        if (mySeat) {\r\n            //如果自己是发起比牌的人\r\n            if (mySeat.seatIndex === dd.gm_manager.zjhGameData.compareSrcIndex) {\r\n                if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n                    dd.mp_manager.playZJH('bp_win');\r\n                } else {\r\n                    dd.mp_manager.playZJH('bp_lose');\r\n                }\r\n            }\r\n            //如果自己是目标比牌的人\r\n            if (mySeat.seatIndex === dd.gm_manager.zjhGameData.compareSrcIndex) {\r\n                if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n                    dd.mp_manager.playZJH('bp_lose');\r\n                } else {\r\n                    dd.mp_manager.playZJH('bp_win');\r\n                }\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * 显示比牌失败的效果\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    showBPWin() {\r\n        let action = cc.fadeOut(0.5);\r\n        let kdNode = null;\r\n        if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n            kdNode = this.dImgList[0].parent;\r\n        } else {\r\n            kdNode = this.dImgList[1].parent;\r\n        }\r\n        kdNode.runAction(action);\r\n    }\r\n\r\n    /**\r\n     * 比牌动作结束回调\r\n     * \r\n     * @memberof ZJH_ActionPK\r\n     */\r\n    actionEnd() {\r\n        let loseSeatId = dd.gm_manager.zjhGameData.compareSrcIndex;\r\n        if (dd.gm_manager.zjhGameData.compareResult === 1) {\r\n            loseSeatId = dd.gm_manager.zjhGameData.compareDstIndex\r\n        }\r\n        this._canvansScript.showQPAction(loseSeatId);\r\n        this.node.removeFromParent(true);\r\n        this.node.destroy();\r\n    }\r\n}\r\n\r\n"]}