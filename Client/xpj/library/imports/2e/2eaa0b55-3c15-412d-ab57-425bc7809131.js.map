{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home/assets\\Script\\SceneScript\\Home\\Recharge.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n\r\n@ccclass\r\nexport default class Recharge extends cc.Component {\r\n    /**\r\n     * 充值金额输入框\r\n     * @type {cc.EditBox}\r\n     * @memberof Recharge\r\n     */\r\n    @property(cc.EditBox)\r\n    edt_buy: cc.EditBox = null;\r\n    /**\r\n     * 充值比例\r\n     * @type {cc.Label}\r\n     * @memberof Recharge\r\n     */\r\n    @property(cc.Label)\r\n    lblRatio: cc.Label = null;\r\n\r\n    onLoad() {\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            event.stopPropagation();\r\n            this.outRecharge();\r\n        }, this);\r\n    }\r\n\r\n    initData(data) {\r\n        this.lblRatio.string = '1元=' + data.rmb2goldMoney + '金币';\r\n    }\r\n    /**\r\n     * 获取充值金币\r\n     * @memberof Recharge\r\n     */\r\n    getBuyGold(money: number, payType: number) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'rmb': money, 'payType': payType };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.ORDER_CHARGE_RMB2GOLDMONEY, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    // dd.ui_manager.showTip('充值请求已发送!');\r\n                    this.edt_buy.string = '';\r\n                    dd.utils.openBrowser(content);\r\n                    this.outRecharge();\r\n                } else if (flag === -1) {//超时\r\n                    dd.ui_manager.showTip('消息超时!');\r\n                } else {//失败,content是一个字符串\r\n                    dd.ui_manager.showTip(content);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * \r\n     * @memberof Recharge\r\n     */\r\n    edit_change(inputStr: string, editBox: cc.EditBox) {\r\n        //如果是特殊符号\r\n        if (isNaN(Number(inputStr))) {\r\n            if (inputStr.length > 1) {\r\n                inputStr = inputStr.substring(0, inputStr.length -1);\r\n                editBox.string = inputStr;\r\n            } else {\r\n                editBox.string = '';\r\n            }\r\n        } else {\r\n            let money = Number(inputStr);\r\n            editBox.string = money + '';\r\n        }\r\n    }\r\n    /**\r\n     * 选择充值方式\r\n     * @memberof Recharge\r\n     */\r\n    click_btn_storeBuy(event, type: string) {\r\n        let moneyStr = this.edt_buy.string.trim();\r\n        if (moneyStr === '' || moneyStr === null) {\r\n            dd.ui_manager.showTip('充值金额不为空');\r\n            return;\r\n        }\r\n        let money = Number(moneyStr);\r\n        if (isNaN(money)) {\r\n            this.edt_buy.string = '';\r\n            dd.ui_manager.showTip('请输入有效的充值金额');\r\n            return;\r\n        }\r\n        if (Math.floor(money) !== money) {\r\n            this.edt_buy.string = '';\r\n            dd.ui_manager.showTip('请输入整数的充值金额');\r\n            return;\r\n        }\r\n        if (money > 0 && money <= 3000) {\r\n            this.getBuyGold(Number(money), Number(type));\r\n        } else {\r\n            dd.ui_manager.showTip('充值金额范围为1~3000，请重新输入');\r\n        }\r\n    }\r\n    /**\r\n     * 退出充值\r\n     * @memberof Recharge\r\n     */\r\n    outRecharge() {\r\n        dd.ui_manager.isShowPopup = true;\r\n        this.node.removeFromParent(true);\r\n        this.node.destroy();\r\n    }\r\n}\r\n"]}