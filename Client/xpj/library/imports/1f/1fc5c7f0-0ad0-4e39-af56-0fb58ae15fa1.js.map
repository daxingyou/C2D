{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Login/assets\\Script\\SceneScript\\Login\\LoginCanvas.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Login","sourcesContent":["import { Protocol } from './../../Modules/Protocol';\r\nconst { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n\r\n@ccclass\r\nexport default class LoginCanvas extends cc.Component {\r\n    @property(cc.Node)\r\n    node_login: cc.Node = null;\r\n    @property(cc.Node)\r\n    node_reg: cc.Node = null;\r\n    /**\r\n     * 手机号输入框\r\n     * \r\n     * @type {cc.EditBox}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_phone: cc.EditBox = null;\r\n    /**\r\n     * 验证码输入框\r\n     * \r\n     * @type {cc.EditBox}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_verfi: cc.EditBox = null;\r\n    /**\r\n     * 登录按钮\r\n     * \r\n     * @type {cc.Button}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.Button)\r\n    btn_login: cc.Button = null;\r\n\r\n    /**\r\n     * 获取验证码按钮\r\n     * \r\n     * @type {cc.Button}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.Button)\r\n    btn_verfi: cc.Button = null;\r\n    /**\r\n     * 获取验证码上的label，获取验证码倒计时\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.Label)\r\n    lbl_verfi: cc.Label = null;\r\n    /**\r\n     * 注册手机号\r\n     * @type {cc.EditBox}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_reg_phone: cc.EditBox = null;\r\n    /**\r\n     * 注册密码\r\n     * @type {cc.EditBox}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_reg_pwd: cc.EditBox = null;\r\n    /**\r\n     * 注册确认密码\r\n     * @type {cc.EditBox}\r\n     * @memberof LoginCanvas\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_reg_pwd2: cc.EditBox = null;\r\n\r\n    _isDownTime: boolean = false;\r\n    _downTime: number = 0;\r\n    _cd: number = 1;\r\n\r\n    async onLoad() {\r\n        if (dd.ui_manager.showLoading('正在连接服务器，请稍后')) {\r\n            let connectState = await this.connectWS();\r\n        }\r\n        this.showLogin(0);\r\n    }\r\n    /**\r\n     * 显示登录界面\r\n     * @param {number} type 0=登录 1=注册\r\n     * @memberof LoginCanvas\r\n     */\r\n    showLogin(type: number) {\r\n        this.node_login.active = type === 0 ? true : false;\r\n        this.node_reg.active = type === 1 ? true : false;\r\n        if (type === 0) {\r\n            if (cc.sys.localStorage.getItem('phone')) {\r\n                this.edit_phone.string = cc.sys.localStorage.getItem('phone');\r\n            }\r\n            if (cc.sys.localStorage.getItem('password')) {\r\n                this.edit_verfi.string = cc.sys.localStorage.getItem('password');\r\n            }\r\n        } else {\r\n            this.edit_reg_phone.string = '';\r\n            this.edit_reg_pwd.string = '';\r\n            this.edit_reg_pwd2.string = '';\r\n        }\r\n    }\r\n    /**\r\n     * 连接游戏服务器\r\n     * \r\n     * @returns {Promise<boolean>} \r\n     * @memberof LoginCanvas\r\n     */\r\n    async connectWS(): Promise<boolean> {\r\n        try {\r\n            await dd.ws_manager.connect(dd.config.wsUrl);//连接服务器\r\n            dd.ui_manager.hideLoading();\r\n            return true;\r\n        } catch (err) {\r\n            cc.log(err);\r\n            let yes: btn_obj = {\r\n                lbl_name: '确定',\r\n                callback: () => {\r\n                    this.onLoad();\r\n                }\r\n            }\r\n            dd.ui_manager.showAlert('连接服务器失败，请确认您的网络后点击确定按钮重新连接！', '错误提示', yes);\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n    * 发送验证码\r\n    * \r\n    * @param {string} phone 手机号\r\n    * @memberof Auth_phone\r\n    */\r\n    sendVaildCode(phone: string) {\r\n        this.btn_verfi.interactable = false;\r\n        this._isDownTime = true;\r\n        this._downTime = 60;\r\n        this._cd = 1;\r\n        this.lbl_verfi.string = this._downTime + 's';\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'phone': phone };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.ACCOUNT_GET_SMS_CODE, msg, (flag: number, content?: any) => {\r\n                if (flag === 0) {//成功\r\n                    cc.log(content);\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    dd.ui_manager.showTip(content);\r\n                }\r\n            });\r\n            dd.ui_manager.hideLoading();\r\n        }\r\n    }\r\n    /**\r\n     *登录手机号\r\n     * \r\n     * @param {string} phone 手机号\r\n     * @param {string} code 验证码\r\n     * @memberof Auth_phone\r\n     */\r\n    sendLogin(phone: string, code: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'phone': phone, 'code': code };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.ACCOUNT_LOGIN_PHONE, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//登录服务器成功\r\n                    cc.sys.localStorage.setItem('phone', phone);\r\n                    cc.sys.localStorage.setItem('password', code);\r\n                    dd.ud_manager.mineData = content as UserData;\r\n                    dd.ws_manager.setLoginState(true);\r\n                    this.turnToHome();\r\n                } else {//登录服务器失败\r\n                    dd.ui_manager.showTip(content);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     *登录手机号\r\n     * \r\n     * @param {string} phone 手机号\r\n     * @param {string} code  密码\r\n     * @memberof Auth_phone\r\n     */\r\n    sendRegister(phone: string, code: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'phone': phone, 'code': code };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.ACCOUNT_REGISTER, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//登录服务器成功\r\n                    cc.sys.localStorage.setItem('phone', phone);\r\n                    cc.sys.localStorage.setItem('password', code);\r\n                    dd.ud_manager.mineData = content as UserData;\r\n                    dd.ws_manager.setLoginState(true);\r\n                    this.turnToHome();\r\n                } else {//登录服务器失败\r\n                    dd.ui_manager.showTip(content);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 手机号验证\r\n     * @param {string} sMobile \r\n     * @returns \r\n     * @memberof LoginCanvas\r\n     */\r\n    checkMobile(sMobile: string) {\r\n        if (!(/^0?(13[0-9]|15[012356789]|17[013678]|18[0-9]|14[57])[0-9]{8}$/.test(sMobile))) {\r\n            dd.ui_manager.showTip(\"*请输入有效的手机号\");\r\n            return false;\r\n        }\r\n        return true;\r\n    }\r\n    /**\r\n     * 登录\r\n     * \r\n     * @returns \r\n     * @memberof LoginCanvas\r\n     */\r\n    click_btn_login() {\r\n        if (!this.btn_login.interactable) return;\r\n        dd.mp_manager.playButton();\r\n        let phoneStr = this.edit_phone.string.trim();\r\n        let verfiStr = this.edit_verfi.string.trim();\r\n        if (phoneStr === '' || phoneStr.length === 0) {\r\n            dd.ui_manager.showTip('*请输入有效的手机号');\r\n            return;\r\n        }\r\n        if (verfiStr === '' || verfiStr.length !== 6) {\r\n            dd.ui_manager.showTip('*请输入6位密码');\r\n            return;\r\n        }\r\n        this.sendLogin(phoneStr, verfiStr);\r\n    }\r\n    /**\r\n     * 登录游戏\r\n     * \r\n     * @memberof LoginCanvas\r\n     */\r\n    turnToHome(): void {\r\n        if (dd.ui_manager.showLoading())\r\n            cc.director.loadScene('HomeScene');\r\n    }\r\n\r\n    update(dt) {\r\n        if (this._isDownTime) {\r\n            this._cd -= dt;\r\n            if (this._cd <= 0) {\r\n                this._cd = 1;\r\n                this._downTime--;\r\n                this.lbl_verfi.string = this._downTime + 's';\r\n                if (this._downTime < 0) {\r\n                    this.btn_verfi.interactable = true;\r\n                    this.lbl_verfi.string = '获取验证码';\r\n                }\r\n            }\r\n        } else {\r\n            this.btn_verfi.interactable = true;\r\n            this.lbl_verfi.string = '获取验证码';\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 点击获取验证码\r\n     * \r\n     * @returns \r\n     * @memberof Auth_phone\r\n     */\r\n    click_btn_verfi() {\r\n        dd.mp_manager.playButton();\r\n        if (!this.btn_verfi.interactable) {\r\n            return;\r\n        }\r\n        let phoneStr = this.edit_phone.string.trim();\r\n        if (phoneStr === '' || phoneStr.length === 0) {\r\n            dd.ui_manager.showTip('*请输入有效的手机号');\r\n            return;\r\n        }\r\n        if (this.checkMobile(phoneStr)) {\r\n            this.sendVaildCode(phoneStr);\r\n        }\r\n    }\r\n    /**\r\n     * 返回到登录界面\r\n     * @memberof LoginCanvas\r\n     */\r\n    click_btn_return() {\r\n        dd.mp_manager.playButton();\r\n        this.showLogin(0);\r\n    }\r\n\r\n    /**\r\n     * 跳转到注册界面\r\n     * @memberof LoginCanvas\r\n     */\r\n    click_btn_turnToReg() {\r\n        dd.mp_manager.playButton();\r\n        this.showLogin(1);\r\n    }\r\n    /**\r\n     * 注册\r\n     * @memberof LoginCanvas\r\n     */\r\n    click_btn_reg() {\r\n        let phoneRegStr = this.edit_reg_phone.string.trim();\r\n        if (phoneRegStr === '' || phoneRegStr.length === 0) {\r\n            dd.ui_manager.showTip('*请输入有效的手机号');\r\n            return;\r\n        }\r\n        let pwdRegStr = this.edit_reg_pwd.string.trim();\r\n        if (pwdRegStr === '' || pwdRegStr.length !== 6) {\r\n            dd.ui_manager.showTip('*请输入6位密码');\r\n            return;\r\n        }\r\n        let pwdRegStr2 = this.edit_reg_pwd2.string.trim();\r\n        if (pwdRegStr2 !== pwdRegStr) {\r\n            dd.ui_manager.showTip('*两次密码输入不一致');\r\n            return;\r\n        }\r\n        //正则表达式检验\r\n        if (this.checkMobile(phoneRegStr)) {\r\n            this.sendRegister(phoneRegStr, pwdRegStr);\r\n        }\r\n    }\r\n}\r\n"]}