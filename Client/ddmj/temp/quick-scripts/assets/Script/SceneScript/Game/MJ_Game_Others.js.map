{"version":3,"sources":["MJ_Game_Others.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Game","sourcesContent":["const { ccclass, property } = cc._decorator;\r\n\r\nimport MJ_Card from './MJ_Card';\r\nimport MJ_Card_Group from './MJ_Card_Group';\r\nimport MJCanvas from './MJCanvas';\r\nimport * as dd from './../../Modules/ModuleManager';\r\nimport * as MJ_Help from './MJ_Help';\r\n\r\n@ccclass\r\nexport default class MJ_Play extends cc.Component {\r\n\r\n    /**\r\n     * 手牌的容器节点\r\n     * \r\n     * @type {cc.Node}\r\n     * @memberof MJ_Play\r\n     */\r\n    @property(cc.Node)\r\n    node_hand: cc.Node = null;\r\n\r\n    /**\r\n     * 提示的文本\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof MJ_Play\r\n     */\r\n    @property(cc.Label)\r\n    lblTip: cc.Label = null;\r\n\r\n    /**\r\n     * 手牌节点列表 0摸牌 1~13手牌\r\n     * \r\n     * @type {cc.Node[]}\r\n     * @memberof MJ_Play\r\n     */\r\n    @property([cc.Node])\r\n    hand_card_list: cc.Node[] = [];\r\n\r\n\r\n    /**\r\n     * canvas脚本\r\n     * \r\n     * @type {MJCanvas}\r\n     * @memberof MJ_Play\r\n     */\r\n    _canvasTarget: MJCanvas = null;\r\n\r\n    /**\r\n     * 当前玩家的信息\r\n     * \r\n     * @type {SeatVo}\r\n     * @memberof MJ_Play\r\n     */\r\n    _seatInfo: SeatVo = null;\r\n    /**\r\n     * 座位索引\r\n     * @type {number}\r\n     * @memberof MJ_Play\r\n     */\r\n    _sId: number = 0;\r\n    onLoad() {\r\n        this._canvasTarget = dd.ui_manager.getCanvasNode().getComponent('MJCanvas');\r\n    }\r\n\r\n    /**\r\n     * 刷新打牌的信息\r\n     * @param {number} sId 座位索引\r\n     * @param {SeatVo} seatInfo 座位信息\r\n     * @memberof MJ_Play\r\n     */\r\n    updatePlay(sId: number, seatInfo: SeatVo) {\r\n        if (!this._canvasTarget) {\r\n            this._canvasTarget = dd.ui_manager.getCanvasNode().getComponent('MJCanvas');\r\n        }\r\n        this._sId = sId;\r\n        this._seatInfo = seatInfo;\r\n        this.showPlayState();\r\n        this.showHandCard();\r\n        this.showMPCard();\r\n    }\r\n\r\n    /**\r\n    *  显示自己的牌 手牌 + 杠牌 + 碰牌\r\n    * \r\n    * @memberof MJ_Play\r\n    */\r\n    showHandCard() {\r\n        if (this._seatInfo.handCardsLen > 0) {\r\n            this.node_hand.active = true;\r\n            //显示其他手牌\r\n            for (var i = 1; i < this.hand_card_list.length; i++) {\r\n                //如果这张牌大于了手牌的长度，就不显示了\r\n                if (i > this._seatInfo.handCardsLen) {\r\n                    this.hand_card_list[i].active = false;\r\n                } else {\r\n                    this.hand_card_list[i].active = true;\r\n                }\r\n            }\r\n        } else {\r\n            this.node_hand.active = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  显示摸牌\r\n     * \r\n     * @memberof MJ_Play\r\n     */\r\n    showMPCard() {\r\n        //如果是自己表态，并且是摸牌状态，牌也存在，就显示\r\n        if (dd.gm_manager.mjGameData.tableBaseVo.btIndex === this._seatInfo.seatIndex\r\n            && this._seatInfo.moPaiCard\r\n        ) {\r\n            this.hand_card_list[0].active = true;\r\n        } else {\r\n            this.hand_card_list[0].active = false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 座位状态的显示\r\n     * \r\n     * @memberof MJ_Play\r\n     */\r\n    showPlayState() {\r\n        switch (dd.gm_manager.mjGameData.tableBaseVo.gameState) {\r\n            //如果在准备阶段，就初始化数据\r\n            case MJ_Help.MJ_GameState.STATE_TABLE_IDLE:\r\n                this.hand_card_list[0].active = false;\r\n                this.node_hand.active = false;\r\n                break;\r\n            case MJ_Help.MJ_GameState.STATE_TABLE_READY: {//游戏准备状态\r\n                this.hand_card_list[0].active = false;\r\n                this.node_hand.active = false;\r\n                this.lblTip.node.active = true;\r\n                if (this._seatInfo.btState === 0) {\r\n                    this.lblTip.string = '等待准备...';\r\n                } else {\r\n                    this.lblTip.string = '已准备...';\r\n                }\r\n                break;\r\n            }\r\n            case MJ_Help.MJ_GameState.STATE_TABLE_SWAPCARD: {//游戏换牌状态\r\n                this.lblTip.node.active = true;\r\n                if (this._seatInfo.btState === 0) {\r\n                    this.lblTip.string = '正在选牌...';\r\n                } else {\r\n                    this.lblTip.string = '已选牌...';\r\n                }\r\n                break;\r\n            }\r\n            case MJ_Help.MJ_GameState.STATE_TABLE_DINGQUE: {//游戏定缺状态\r\n                this.lblTip.node.active = true;\r\n                if (this._seatInfo.btState === 0) {\r\n                    this.lblTip.string = '定缺中...';\r\n                } else {\r\n                    this.lblTip.string = '已定缺...';\r\n                }\r\n                break;\r\n            }\r\n            default:\r\n                this.lblTip.node.active = false;\r\n                break;\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}