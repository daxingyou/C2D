{"version":3,"sources":["Game_Chat.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Game","sourcesContent":["import { mp_manager, ui_manager } from './../../Modules/ModuleManager';\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game_Chat extends cc.Component {\r\n\r\n    @property(cc.Node)\r\n    chat_info: cc.Node = null;\r\n\r\n    /**\r\n     * 聊天的文字列表容器\r\n     * \r\n     * @type {cc.ScrollView}\r\n     * @memberof Game_Chat\r\n     */\r\n    @property(cc.ScrollView)\r\n    svNode: cc.ScrollView = null;\r\n\r\n    /**\r\n     * 聊天表情的列表容器\r\n     * \r\n     * @type {cc.ScrollView}\r\n     * @memberof Game_Chat\r\n     */\r\n    @property(cc.ScrollView)\r\n    bqNode: cc.ScrollView = null;\r\n\r\n    @property(cc.Toggle)\r\n    toggle_chat: cc.Toggle = null;\r\n\r\n    @property(cc.Toggle)\r\n    toggle_bq: cc.Toggle = null;\r\n    /**\r\n     * 表情节点列表\r\n     * \r\n     * @type {cc.Node[]}\r\n     * @memberof Game_Chat\r\n     */\r\n    _bqList: cc.Node[] = [];\r\n\r\n    /**\r\n     * canvas脚本\r\n     * \r\n     * @memberof Game_Chat\r\n     */\r\n    _canvasTarget = null;\r\n    onLoad() {\r\n        this._canvasTarget = ui_manager.getCanvasNode().getComponent('MJCanvas');\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            this.exitChat();\r\n            event.stopPropagation();\r\n        }, this);\r\n        this.initData();\r\n        this.showChatLayer(0);\r\n        this.bindEvent();\r\n    }\r\n\r\n    /**\r\n     * 退出聊天\r\n     * \r\n     * @memberof Game_Chat\r\n     */\r\n    exitChat() {\r\n        this.node.active = false;\r\n    }\r\n\r\n    click_quickInfo = (event: cc.Event.EventTouch) => {\r\n        mp_manager.playButton();\r\n        let chatNode: cc.Node = event.currentTarget;\r\n        cc.log(chatNode.tag);\r\n        this._canvasTarget.sendChatInfo(0, chatNode.tag);\r\n        this.exitChat();\r\n    };\r\n\r\n    initData() {\r\n        let quickList = mp_manager.quicklyList;\r\n        for (var i = 0; i < quickList.length; i++) {\r\n            let quickInfo = quickList[i];\r\n            if (i === 0) {\r\n                this.chat_info.tag = quickInfo.id;\r\n                this.chat_info.getComponent(cc.Label).string = quickInfo.msg;\r\n                this.chat_info.on(cc.Node.EventType.TOUCH_END, this.click_quickInfo, this);\r\n            } else {\r\n                let chatNode = cc.instantiate(this.chat_info);\r\n                chatNode.tag = quickInfo.id;\r\n                chatNode.getComponent(cc.Label).string = quickInfo.msg;\r\n                chatNode.parent = this.svNode.content;\r\n                chatNode.on(cc.Node.EventType.TOUCH_END, this.click_quickInfo, this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 绑定事件\r\n     * \r\n     * @memberof Game_Chat\r\n     */\r\n    bindEvent() {\r\n        let childLen = this.bqNode.content.childrenCount;\r\n        for (var i = 0; i < childLen; i++) {\r\n            let bqName = 'biaoqing_' + (i + 1);\r\n            let bqNode: cc.Node = cc.find(bqName, this.bqNode.content);\r\n            bqNode.tag = i;\r\n            if (bqNode) {\r\n                bqNode.on(cc.Node.EventType.TOUCH_END, () => {\r\n                    this._canvasTarget.sendChatInfo(1, bqNode.tag);\r\n                    this.exitChat();\r\n                }, this);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示聊天界面\r\n     * \r\n     * @param {number} type \r\n     * @memberof Game_Chat\r\n     */\r\n    showChatLayer(type: number) {\r\n        this.svNode.node.active = type === 0 ? true : false;\r\n        this.bqNode.node.active = type === 0 ? false : true;\r\n        this.toggle_chat.isChecked = type === 0 ? true : false;\r\n        this.toggle_bq.isChecked = type === 0 ? false : true;\r\n    }\r\n\r\n    /**\r\n     * 复选框的点击事件\r\n     * \r\n     * @param {any} event \r\n     * @param {string} type 0=聊天 1=表情\r\n     * @memberof Game_Chat\r\n     */\r\n    click_btn_chat(event, type: string) {\r\n        mp_manager.playButton();\r\n        this.svNode.node.active = type === '0' ? true : false;\r\n        this.bqNode.node.active = type === '0' ? false : true;\r\n    }\r\n}\r\n"]}