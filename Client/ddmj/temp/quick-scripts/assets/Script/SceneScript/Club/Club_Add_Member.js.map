{"version":3,"sources":["Club_Add_Member.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Club","sourcesContent":["import * as dd from './../../Modules/ModuleManager';\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Club_Add_Member extends cc.Component {\r\n\r\n    /**\r\n     * 输入框\r\n     * \r\n     * @type {cc.EditBox}\r\n     * @memberof Club_Add_Member\r\n     */\r\n    @property(cc.EditBox)\r\n    edit_starNo: cc.EditBox = null;\r\n\r\n    /**\r\n     * 信息提示\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof Club_Add_Member\r\n     */\r\n    @property(cc.Label)\r\n    lblMsg: cc.Label = null;\r\n\r\n    @property(cc.Node)\r\n    node_player: cc.Node = null;\r\n\r\n    @property(cc.Sprite)\r\n    headImg: cc.Sprite = null;\r\n\r\n    @property(cc.Label)\r\n    lblName: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblId: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblIP: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblBtnName1: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblBtnName2: cc.Label = null;\r\n    /**\r\n     * 俱乐部信息\r\n     * \r\n     * @type {CorpsVoInner}\r\n     * @memberof Club_Add_Member\r\n     */\r\n    _clubInfo: CorpsVoInner = null;\r\n    /**\r\n     * 脚本\r\n     * \r\n     * @memberof Club_Add_Member\r\n     */\r\n    _canvasTarget = null;\r\n\r\n    _roleInfo: UserData = null;\r\n\r\n    onLoad() {\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            this.node.active = false;\r\n            event.stopPropagation();\r\n        }, this);\r\n        this.lblMsg.string = '';\r\n        this.edit_starNo.string = '';\r\n    }\r\n    initData(clubInfo: CorpsVoInner, target) {\r\n        this._canvasTarget = target;\r\n        this._clubInfo = clubInfo;\r\n        this.showAddLayer(0);\r\n    }\r\n\r\n    showAddLayer(type: number = 0) {\r\n        this.edit_starNo.string = '';\r\n        this.lblMsg.string = '';\r\n        if (type === 0) {\r\n            this.edit_starNo.node.active = true;\r\n            this.node_player.active = false;\r\n            this.lblBtnName1.string = '搜索好友';\r\n            this.lblBtnName2.string = '取消搜索';\r\n        } else {\r\n            this.edit_starNo.node.active = false;\r\n            this.node_player.active = true;\r\n            this.lblBtnName1.string = '邀请好友';\r\n            this.lblBtnName2.string = '取消邀请';\r\n        }\r\n    }\r\n    /**\r\n     * 显示提示信息\r\n     * \r\n     * @param {number} type \r\n     * @param {string} msg \r\n     * @memberof Club_Add_Member\r\n     */\r\n    showMsg(type: number, msg: string) {\r\n        this.lblMsg.node.color = type === 0 ? cc.Color.RED : cc.Color.GREEN;\r\n        this.lblMsg.string = msg;\r\n    }\r\n\r\n    /**\r\n     * 添加成员到俱乐部\r\n     * \r\n     * @param {string} starNO \r\n     * @memberof Club\r\n     */\r\n    sendAddMember(starNO: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'corpsId': this._clubInfo.corpsId, 'starNO': starNO };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.CORPS_ADD_MEMBER, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    this._canvasTarget.showClub(2);\r\n                    this.showMsg(1, '添加成功，可以添加继续添加下一位');\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    this.showMsg(0, content);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 获取玩家信息\r\n     * @param {string} starNode \r\n     * @memberof Club_Add_Member\r\n     */\r\n    sendGetRoleInfo(starNode: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            dd.mp_manager.playAlert();\r\n            let obj = { 'starNO': starNode };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.ACCOUNT_ROLE_STARNO, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    this.showAddLayer(1);\r\n                    let roleInfo = content as UserData;\r\n                    this.showHead(roleInfo);\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    this.showMsg(0, content);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    async showHead(roleInfo: UserData) {\r\n        this._roleInfo = roleInfo;\r\n        this.lblId.string = 'ID:' + roleInfo.starNO;\r\n        this.lblIP.string = 'IP: ' + roleInfo.clientIP;\r\n        this.lblName.string = roleInfo.nick;\r\n        let headSF = null;\r\n        try {\r\n            headSF = await dd.img_manager.loadURLImage(roleInfo.headImg);\r\n        } catch (error) {\r\n            cc.log('获取头像错误');\r\n        }\r\n        this.headImg.spriteFrame = headSF;\r\n    }\r\n\r\n    /**\r\n     * 添加成员\r\n     * \r\n     * @returns \r\n     * @memberof Club_Add_Member\r\n     */\r\n    click_btn_add() {\r\n        dd.mp_manager.playButton();\r\n        if (this.edit_starNo.node.active) {\r\n            let starNO = this.edit_starNo.string.trim();\r\n            if (starNO === '' || starNO.length === 0) {\r\n                this.showMsg(0, '*玩家ID不能为空,请重新输入！');\r\n                return;\r\n            }\r\n            this.sendGetRoleInfo(starNO);\r\n        } else {\r\n            if (this._roleInfo) {\r\n                let starNO = this._roleInfo.starNO;\r\n                this.sendAddMember(starNO);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 退出\r\n     * \r\n     * @memberof Club_Add_Member\r\n     */\r\n    click_btn_out() {\r\n        dd.mp_manager.playButton();\r\n        if (this.edit_starNo.node.active) {\r\n            this.node.active = false;\r\n        } else {\r\n            this.showAddLayer(0);\r\n        }\r\n    }\r\n}\r\n"]}