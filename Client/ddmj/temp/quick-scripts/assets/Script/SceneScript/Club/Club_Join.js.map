{"version":3,"sources":["Club_Join.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Club","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n\r\n    @property(cc.EditBox)\r\n    edit_clubId: cc.EditBox = null;\r\n\r\n    @property(cc.Node)\r\n    node_club_info: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    lblClubName: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblClubNum: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblErr: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblBtnName1: cc.Label = null;\r\n\r\n    @property(cc.Label)\r\n    lblBtnName2: cc.Label = null;\r\n\r\n    _clubInfo: CorpsDetailed = null;\r\n    onLoad() {\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            this.node.active = false;\r\n            event.stopPropagation();\r\n        }, this);\r\n        this.showLayer(0);\r\n    }\r\n\r\n    showLayer(type: number) {\r\n        this.edit_clubId.string = '';\r\n        this.lblErr.string = '';\r\n        this.edit_clubId.node.active = type === 0 ? true : false;\r\n        this.node_club_info.active = type === 1 ? true : false;\r\n        this.lblBtnName1.string = type === 0 ? '搜索俱乐部' : '确认加入';\r\n        this.lblBtnName2.string = type === 0 ? '取消搜索' : '取消加入';\r\n    }\r\n    /**\r\n      * 根据俱乐部id获取俱乐部信息\r\n      * \r\n      * @memberof Room_Join_Club\r\n      */\r\n    sendGetClubByClubId(clubId: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'corpsId': clubId };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.CORPS_GET_CORPS_DETAILED, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    let data = content as CorpsDetailed;\r\n                    if (data) {\r\n                        this._clubInfo = data;\r\n                        this.showLayer(1);\r\n                        this.showClubInfo(data);\r\n                    }\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    this.lblErr.string = '*' + content;\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 发送加入俱乐部申请\r\n     * @memberof NewClass\r\n     */\r\n    sendJoinClub() {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'corpsId': this._clubInfo.corpsId };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.CORPS_QUEST_JOIN, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    dd.ui_manager.showTip('已提交您的申请');\r\n                    this.node.active = false;\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    dd.ui_manager.showAlert(content, '温馨提示');\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 显示俱乐部信息\r\n     * \r\n     * @param {CorpsDetailed} data \r\n     * @memberof NewClass\r\n     */\r\n    showClubInfo(data: CorpsDetailed) {\r\n        this.lblClubName.string = data.corpsName;\r\n        if (data.members) {\r\n            this.lblClubNum.string = data.members.length + '';\r\n        } else {\r\n            this.lblClubNum.string = '0';\r\n        }\r\n    }\r\n\r\n    click_btn_ok() {\r\n        dd.mp_manager.playButton();\r\n        if (this.node_club_info.active) {\r\n            this.sendJoinClub();\r\n        } else {\r\n            let clubId = this.edit_clubId.string.trim();\r\n            if (clubId === '') {\r\n                this.lblErr.string = '*请输入俱乐部ID';\r\n                return;\r\n            }\r\n            this.sendGetClubByClubId(clubId);\r\n        }\r\n    }\r\n\r\n    click_btn_cancel() {\r\n        dd.mp_manager.playButton();\r\n        if (this.node_club_info.active) {\r\n            this.showLayer(0);\r\n        } else {\r\n            this.node.active = false;\r\n        }\r\n    }\r\n}\r\n"]}