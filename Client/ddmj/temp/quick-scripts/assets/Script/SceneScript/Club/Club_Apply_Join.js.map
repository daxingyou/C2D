{"version":3,"sources":["Club_Apply_Join.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Club","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\nimport * as dd from './../../Modules/ModuleManager';\r\n@ccclass\r\nexport default class Club_Apply_Join extends cc.Component {\r\n\r\n    @property(cc.Label)\r\n    lblTip: cc.Label = null;\r\n\r\n    @property(cc.ScrollView)\r\n    svNode_apply: cc.ScrollView = null;\r\n\r\n    @property(cc.Prefab)\r\n    apply_prefab: cc.Prefab = null;\r\n    /**\r\n     * 俱乐部信息\r\n     * \r\n     * @type {CorpsVoInner}\r\n     * @memberof Club\r\n     */\r\n    _clubInfo: CorpsVoInner = null;\r\n\r\n    _applyList = [];\r\n    onLoad() {\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            this.node.active = false;\r\n            event.stopPropagation();\r\n        }, this);\r\n\r\n    }\r\n    /**\r\n     * 初始化数据\r\n     * @param {CorpsVoInner} clubInfo \r\n     * @memberof Club_Apply_Join\r\n     */\r\n    initData(clubInfo: CorpsVoInner) {\r\n        this._clubInfo = clubInfo;\r\n        this.sendGetApplyInfo();\r\n    }\r\n    /**\r\n     * 获取申请列表\r\n     * @memberof Club_Apply_Join\r\n     */\r\n    sendGetApplyInfo() {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'corpsId': this._clubInfo.corpsId };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.CORPS_GET_QUESTJOIN_LIST, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    this.showApplyList(content);\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    dd.ui_manager.showAlert(content, '温馨提示');\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 发送申请回复\r\n     * @param {string} starNO 玩家Id,'0'就表示全部\r\n     * @param {number} bt  (0=拒绝,1=同意)\r\n     * @memberof Club_Apply_Join\r\n     */\r\n    sendApplyAnwser(starNO: string, bt: number) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = {\r\n                'corpsId': this._clubInfo.corpsId,\r\n                'starNO': starNO,\r\n                'bt': bt\r\n            };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.CORPS_QUEST_JOIN_BT, msg, (flag: number, content?: any) => {\r\n                dd.ui_manager.hideLoading();\r\n                if (flag === 0) {//成功\r\n                    this.sendGetApplyInfo();\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    dd.ui_manager.showAlert(content, '温馨提示');\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 显示申请列表\r\n     * @param {any} data \r\n     * @memberof Club_Apply_Join\r\n     */\r\n    showApplyList(data) {\r\n        this.svNode_apply.content.removeAllChildren();\r\n        if (data && data.items) {\r\n            this._applyList = data.items;\r\n            this.lblTip.node.active = false;\r\n            for (var i = 0; i < data.items.length; i++) {\r\n                let apply = cc.instantiate(this.apply_prefab);\r\n                apply.parent = this.svNode_apply.content;\r\n                let apply_script = apply.getComponent('Club_Apply_Join_Item');\r\n                apply_script.updateItem(data.items[i], this);\r\n            }\r\n        } else {\r\n            this.lblTip.node.active = true;\r\n        }\r\n    }\r\n    /**\r\n     * 全部拒绝\r\n     * @memberof Club_Apply_Join\r\n     */\r\n    click_btn_refuseAll() {\r\n        dd.mp_manager.playButton();\r\n        if (this._applyList.length === 0) return;\r\n        this.sendApplyAnwser('0', 0);\r\n    }\r\n    /**\r\n     * 全部通过\r\n     * @memberof Club_Apply_Join\r\n     */\r\n    click_btn_agreeAll() {\r\n        dd.mp_manager.playButton();\r\n        if (this._applyList.length === 0) return;\r\n        this.sendApplyAnwser('0', 1);\r\n    }\r\n}\r\n"]}