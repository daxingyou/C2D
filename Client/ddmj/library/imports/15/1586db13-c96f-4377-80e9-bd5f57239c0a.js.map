{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home/assets\\Script\\SceneScript\\Home\\Auth.ts"],"names":[],"mappings":";;;;;AACM,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAAQ,CAAmB;AAE5C,kDAAoD;AAEpD;IAAkC,wBAAY;IAD9C;QAAA,qEA4IC;QAzIG;;;;;WAKG;QAEH,YAAM,GAAa,IAAI,CAAC;QACxB;;;;;WAKG;QAEH,aAAO,GAAe,IAAI,CAAC;QAE3B;;;;;WAKG;QAEH,WAAK,GAAe,IAAI,CAAC;;IAiH7B,CAAC;IA/GG,qBAAM,GAAN;QAAA,iBAcC;QAbG,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,UAAU,EAAE,UAAC,KAA0B;YAChD,EAAE,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;YAC3B,EAAE,CAAC,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC;YACjC,KAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YACjC,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;YACpB,KAAK,CAAC,eAAe,EAAE,CAAC;QAC5B,CAAC,EAAE,IAAI,CAAC,CAAC;QACT,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,EAAE,CAAC;QACxB,EAAE,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,IAAI,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/F,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC;QACnC,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;QAC3B,CAAC;IACL,CAAC;IAED;;;;;;OAMG;IACH,uBAAQ,GAAR,UAAS,IAAY,EAAE,MAAc;QAArC,iBAeC;QAdG,EAAE,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;YAC9B,IAAI,GAAG,GAAG,EAAE,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,CAAC;YAC7C,IAAI,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,CAAC;YAC9B,EAAE,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,CAAC,QAAQ,CAAC,8BAA8B,EAAE,GAAG,EAAE,UAAC,IAAY,EAAE,OAAa;gBAC/F,EAAE,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;oBACb,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,GAAG,CAAC,CAAC;oBAC9C,KAAI,CAAC,OAAO,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;gBAC/B,CAAC;gBAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;gBACzB,CAAC;gBAAC,IAAI,CAAC,CAAC;oBACJ,EAAE,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC;gBACpB,CAAC;YACL,CAAC,CAAC,CAAC;YACH,EAAE,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;QAChC,CAAC;IACL,CAAC;IAED;;;;;;;OAOG;IACH,sBAAO,GAAP,UAAQ,IAAY,EAAE,GAAW,EAAE,OAAmB;QAAnB,wBAAA,EAAA,WAAmB;QAClD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,OAAO,GAAG,GAAG,CAAC;QAC/B,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,CAAC;QAClC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC5D,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;QAC1D,IAAI,CAAC,MAAM,CAAC,MAAM,GAAG,GAAG,CAAC;QACzB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,KAAK,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC;QACpE,IAAI,CAAC,MAAM,CAAC,QAAQ,GAAG,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,CAAC;QAC5C,4DAA4D;QAC5D,oHAAoH;QACpH,EAAE,CAAC,CAAC,IAAI,KAAK,CAAC,CAAC,CAAC,CAAC;YACb,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,CAAC,EAAE,GAAG,CAAC,CAAC;YACxC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,GAAG,CAAC,CAAC;YACpC,IAAI,GAAG,GAAG,OAAO,KAAK,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,WAAW,EAAE,CAAC;YACxG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;YAC1C,IAAI,MAAM,GAAG,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,UAAC,MAAe,EAAE,IAAU;gBAC7F,MAAM,CAAC,OAAO,GAAG,GAAG,CAAC;gBACrB,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,EAAE,CAAC;YAC9C,CAAC,EAAE,IAAI,CAAC,CAAC,CAAC;YACV,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;QACvC,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC;QAC9C,CAAC;IACL,CAAC;IACD;;;;OAIG;IACH,6BAAc,GAAd;QACI,EAAE,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;QAC3B,aAAa;QACb,EAAE,CAAC,CAAC,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,IAAI,EAAE,CAAC,UAAU,CAAC,QAAQ,CAAC,kBAAkB,KAAK,CAAC,CAAC,CAAC,CAAC;YAC/F,EAAE,CAAC,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;YACjC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;QACxB,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YACzC,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,EAAE,CAAC;YACrC,EAAE,CAAC,CAAC,OAAO,KAAK,EAAE,IAAI,OAAO,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC;gBACzC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,gBAAgB,EAAE,CAAC,CAAC,CAAC;gBACrC,MAAM,CAAC;YACX,CAAC;YACD,EAAE,CAAC,CAAC,KAAK,KAAK,EAAE,IAAI,KAAK,CAAC,MAAM,KAAK,EAAE,CAAC,CAAC,CAAC;gBACtC,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,eAAe,EAAE,CAAC,CAAC,CAAC;gBACpC,MAAM,CAAC;YACX,CAAC;YACD,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;QAClC,CAAC;IACL,CAAC;IAED;;;;OAIG;IACH,4BAAa,GAAb;QACI,EAAE,CAAC,UAAU,CAAC,UAAU,EAAE,CAAC;QAC3B,EAAE,CAAC,UAAU,CAAC,WAAW,GAAG,IAAI,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,CAAC;QACjC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC;IACxB,CAAC;IAjID;QADC,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC;wCACK;IAQxB;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;yCACM;IAS3B;QADC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC;uCACI;IA1BR,IAAI;QADxB,OAAO;OACa,IAAI,CA2IxB;IAAD,WAAC;CA3ID,AA2IC,CA3IiC,EAAE,CAAC,SAAS,GA2I7C;kBA3IoB,IAAI","file":"","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\Script\\SceneScript\\Home","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\n\r\nimport * as dd from './../../Modules/ModuleManager';\r\n@ccclass\r\nexport default class Auth extends cc.Component {\r\n\r\n    /**\r\n     * 实名认证的提示\r\n     * \r\n     * @type {cc.Label}\r\n     * @memberof Auth\r\n     */\r\n    @property(cc.Label)\r\n    lblMsg: cc.Label = null;\r\n    /**\r\n     * 名称输入框\r\n     * \r\n     * @type {cc.EditBox}\r\n     * @memberof Auth\r\n     */\r\n    @property(cc.EditBox)\r\n    eb_name: cc.EditBox = null;\r\n\r\n    /**\r\n     * 身份证输入框\r\n     * \r\n     * @type {cc.EditBox}\r\n     * @memberof Auth\r\n     */\r\n    @property(cc.EditBox)\r\n    eb_id: cc.EditBox = null;\r\n\r\n    onLoad() {\r\n        this.node.on(\"touchend\", (event: cc.Event.EventTouch) => {\r\n            dd.mp_manager.playButton();\r\n            dd.ui_manager.isShowPopup = true;\r\n            this.node.removeFromParent(true);\r\n            this.node.destroy();\r\n            event.stopPropagation();\r\n        }, this);\r\n        this.lblMsg.string = '';\r\n        if (dd.ud_manager.mineData.authenticationFlag && dd.ud_manager.mineData.authenticationFlag === 1) {\r\n            this.showMsg(1, '您已经实名认证过了哦！');\r\n        } else {\r\n            this.showMsg(0, '', 0);\r\n        }\r\n    }\r\n\r\n    /**\r\n     *  玩家实名认证\r\n     * \r\n     * @param {string} name 姓名\r\n     * @param {string} cardId 身份证\r\n     * @memberof Auth\r\n     */\r\n    sendAuth(name: string, cardId: string) {\r\n        if (dd.ui_manager.showLoading()) {\r\n            let obj = { 'name': name, 'cardId': cardId };\r\n            let msg = JSON.stringify(obj);\r\n            dd.ws_manager.sendMsg(dd.protocol.REPLAY_REALNAME_AUTHENTICATION, msg, (flag: number, content?: any) => {\r\n                if (flag === 0) {//成功\r\n                    dd.ud_manager.mineData.authenticationFlag = 1;\r\n                    this.showMsg(1, '实名认证成功！');\r\n                } else if (flag === -1) {//超时\r\n                } else {//失败,content是一个字符串\r\n                    cc.log(content);\r\n                }\r\n            });\r\n            dd.ui_manager.hideLoading();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示提示信息\r\n     * \r\n     * @param {number} type  0未实名 1已实名\r\n     * @param {number} errType 0名字 1身份证\r\n     * @param {string} msg \r\n     * @memberof Auth\r\n     */\r\n    showMsg(type: number, msg: string, errType: number = 0) {\r\n        this.lblMsg.node.opacity = 255;\r\n        this.lblMsg.node.stopAllActions();\r\n        this.eb_name.node.parent.active = type === 0 ? true : false;\r\n        this.eb_id.node.parent.active = type === 0 ? true : false;\r\n        this.lblMsg.string = msg;\r\n        this.lblMsg.node.color = type === 0 ? cc.Color.RED : cc.Color.WHITE;\r\n        this.lblMsg.fontSize = type === 0 ? 30 : 40;\r\n        // let msgWidget = this.lblMsg.node.getComponent(cc.Widget);\r\n        // msgWidget.verticalCenter = type === 0 ? -Math.abs(msgWidget.verticalCenter) : Math.abs(msgWidget.verticalCenter);\r\n        if (type === 0) {\r\n            this.lblMsg.node.setAnchorPoint(0, 0.5);\r\n            this.lblMsg.node.setPositionX(-120);\r\n            let pos = errType === 0 ? this.eb_name.node.parent.getPosition() : this.eb_id.node.parent.getPosition();\r\n            this.lblMsg.node.setPositionY(pos.y - 50);\r\n            let action = cc.sequence(cc.delayTime(2), cc.fadeOut(1), cc.callFunc((target: cc.Node, data?: any) => {\r\n                target.opacity = 255;\r\n                target.getComponent(cc.Label).string = '';\r\n            }, this));\r\n            this.lblMsg.node.runAction(action);\r\n        } else {\r\n            this.lblMsg.node.setAnchorPoint(0.5, 0.5);\r\n            this.lblMsg.node.setPosition(cc.p(0, 30));\r\n        }\r\n    }\r\n    /**\r\n     * 认证按钮点击事件\r\n     * \r\n     * @memberof Auth\r\n     */\r\n    click_btn_auth() {\r\n        dd.mp_manager.playButton();\r\n        //如果实名认证了，就退出\r\n        if (dd.ud_manager.mineData.authenticationFlag && dd.ud_manager.mineData.authenticationFlag === 1) {\r\n            dd.ui_manager.isShowPopup = true;\r\n            this.node.removeFromParent(true);\r\n            this.node.destroy();\r\n        } else {\r\n            let nameStr = this.eb_name.string.trim();\r\n            let idStr = this.eb_id.string.trim();\r\n            if (nameStr === '' || nameStr.length === 0) {\r\n                this.showMsg(0, '*姓名不能为空,请重新输入！', 0);\r\n                return;\r\n            }\r\n            if (idStr === '' || idStr.length !== 18) {\r\n                this.showMsg(0, '*请输入有效的身份证号码！', 1);\r\n                return;\r\n            }\r\n            this.sendAuth(nameStr, idStr);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 退出\r\n     * \r\n     * @memberof Auth\r\n     */\r\n    click_btn_out() {\r\n        dd.mp_manager.playButton();\r\n        dd.ui_manager.isShowPopup = true;\r\n        this.node.removeFromParent(true);\r\n        this.node.destroy();\r\n    }\r\n}\r\n"]}